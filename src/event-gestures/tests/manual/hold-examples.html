<!doctype html>
<html>
<head>
    <title>event-hold examples</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width" />
    <link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/pure/0.3.0/pure-min.css">
    <!-- This will pull in the pointer from gallery-widget-pointer -->
    <link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/gallery-2013.03.27-22-06/build/gallery-widget-pointer/assets/gallery-widget-pointer-core.css">

    <!-- This will pull in tipsy styles -->
    <link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/gallery-2013.03.27-22-06/build/gallery-tipsy/assets/skins/sam/gallery-tipsy.css">

    <link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/gallery-2013.03.27-22-06/build/gallery-popover/assets/skins/sam/gallery-popover-skin.css">

    <style>
    body {
        font-family: sans-serif;
        padding: 1em;
    }

    .kudo {
        position: relative;
        border-radius: 100%;
        -webkit-border-radius: 100%;
        -moz-border-radius: 100%;
        -webkit-touch-callout: none;
        margin-bottom: 0;
        margin-top: 50px;
        padding-left: 15px;
        min-height: 90px;
        display: inline;
    }

    .kudo a {
        position: relative;
        background-color: #fff;
        display: inline-block;
        float: left;
        top: 3px;
        width: 48px;
        height: 48px;
        border-radius: 100%;
        -webkit-border-radius: 100%;
        -moz-border-radius: 100%;
        border: 4px solid #000;
        cursor: default;
    }

    div.kudo div.filling {
        position: absolute;
        background-color: #000;
        display: block;
        width: 42px;
        height: 42px;
        top: 3px;
        left: 3px;
        background-repeat: no-repeat;
        background-position: center center;
        background-size: 100%;
        border-radius: 100%;
        -webkit-border-radius: 100%;
        -moz-border-radius: 100%;
        -webkit-transform: scale(0.3);
        -webkit-transition-property: opacity, background-color, -webkit-transform;
        -webkit-transition-duration: 2s;
        -webkit-transition-timing-function: ease-out;
        -moz-transform: scale(0.3);
        -moz-transition-property: opacity, background-color, -moz-transform;
        -moz-transition-duration: 2s;
        -moz-transition-timing-function: ease-out;
        transform: scale(0.3);
        transition-property: opacity, background-color, transform;
        transition-duration: 2s;
        transition-timing-function: ease-out;
    }
    div.kudo.activated div.filling {
        transform: scale(1.3);
        -webkit-transform:scale(1.3);
        -moz-transform:scale(1.3);
    }

    div.kudo.complete div.filling {
        background-image: url(//d1jcp5e5r52ocf.cloudfront.net/rocket.png);
        background-color: red;
        -webkit-transition-property:none;
        -webkit-animation:bounce 1s;
        -webkit-animation-iteration-count:1;
        -webkit-transform:scale(1);
        -moz-transition-property:none;
        -moz-animation:bounce 1s;
        -moz-animation-iteration-count:1;
        -moz-transform:scale(1);
        transition-property:none;
        animation:bounce 1s;
        animation-iteration-count:1;
        transform:scale(1);
    }

    .kudo .text {
        float: left;
        display: inline;
        margin-top: 1.3em;
        margin-left: 1em;
        text-transform: uppercase;
        font-weight: bold;
    }

    .clearfix {
        clear: both;
    }
    .btn {
        background-color: #fff;
        background-image: -webkit-linear-gradient(rgba(255,255,255,0),#f0f2f6 90%,#e5e8ee);
        background-image: -moz-linear-gradient(rgba(255,255,255,0),#f0f2f6 90%,#e5e8ee);
        background-image: -ms-linear-gradient(rgba(255,255,255,0),#f0f2f6 90%,#e5e8ee);
        background-image: -o-linear-gradient(rgba(255,255,255,0),#f0f2f6 90%,#e5e8ee);
        background-image: linear-gradient(rgba(255,255,255,0),#f0f2f6 90%,#e5e8ee);
        -webkit-box-shadow: 0 1px 1px 0 rgba(0,0,0,0.1),inset 0 1px 0 0 #fff;
        -moz-box-shadow: 0 1px 1px 0 rgba(0,0,0,0.1),inset 0 1px 0 0 #fff;
        -ms-box-shadow: 0 1px 1px 0 rgba(0,0,0,0.1),inset 0 1px 0 0 #fff;
        -o-box-shadow: 0 1px 1px 0 rgba(0,0,0,0.1),inset 0 1px 0 0 #fff;
        box-shadow: 0 1px 1px 0 rgba(0,0,0,0.1),inset 0 1px 0 0 #fff;
        -webkit-border-radius: 4px;
        -moz-border-radius: 4px;
        -ms-border-radius: 4px;
        -o-border-radius: 4px;
        border-radius: 4px;
        border: 1px solid rgba(152,164,184,0.8);
        border-bottom-color: #a2adbf;
        border-top-color: rgba(152,164,184,0.6);
        cursor: pointer;
        outline: 0;
        color: #707885;
        line-height: 24px;
        text-shadow: 0 1px 0 #fff;
        -webkit-user-select: none;
        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
    }

    .module {
        display: inline-block;
        position: relative;
    }
    .module, .module img {
        -webkit-user-select: none;
        -webkit-user-drag: none;
        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
    }

    .module .close {
        position: absolute;
        top: -10px;
        right: -10px;
        background: rgb(207, 0, 0);
        color: white;
        border-radius: 50px;
        padding: 0.2em 0.5em;
    }

    .animated{-webkit-animation-iteration-count: infinite;-webkit-animation-fill-mode:both;-moz-animation-fill-mode:both;-ms-animation-fill-mode:both;-o-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-duration:0.4s;-moz-animation-duration:0.4s;-ms-animation-duration:0.4s;-o-animation-duration:0.4s;animation-duration:0.4s;}.animated.hinge{-webkit-animation-duration:0.4s;-moz-animation-duration:0.4s;-ms-animation-duration:0.4s;-o-animation-duration:0.4s;animation-duration:0.4s;}

    @-webkit-keyframes wobble {
      0% { -webkit-transform: translateX(0%); rotate(2deg); }
      15% { -webkit-transform: translateX(-3%) rotate(-2deg); }
      30% { -webkit-transform: translateX(3%) rotate(2deg); }
      45% { -webkit-transform: translateX(-3%) rotate(-2deg); }
      60% { -webkit-transform: translateX(3%) rotate(2deg); }
      75% { -webkit-transform: translateX(-3%) rotate(-2deg); }
      100% { -webkit-transform: translateX(5%); rotate(2deg);}
    }

    @keyframes wobble {
        0% { -webkit-transform: translateX(0%); rotate(2deg); }
        15% { -webkit-transform: translateX(-3%) rotate(-2deg); }
        30% { -webkit-transform: translateX(3%) rotate(2deg); }
        45% { -webkit-transform: translateX(-3%) rotate(-2deg); }
        60% { -webkit-transform: translateX(3%) rotate(2deg); }
        75% { -webkit-transform: translateX(-3%) rotate(-2deg); }
        100% { -webkit-transform: translateX(3%); rotate(2deg);}
    }

    .wobble {
        -webkit-animation-name: wobble;
        -moz-animation-name: wobble;
        -o-animation-name: wobble;
        animation-name: wobble;
    }
    .hidden {
        display: none !important;
    }
    </style>


</head>
<body>

    <script src="../../../../build/yui/yui.js"></script>

    <h2>Svbtle-like Vote Indicator</h2>
    <div class="kudo able">
    <a href="#kudo">
        <div class="filling">&nbsp;</div>
    </a>
    <div class="text">Hold to add a vote</div>
    </div>

    <div class="clearfix"></div>

    <h2>Change state on `hold`</h2>
    <div class="module">
        <img class="animated" src="https://encrypted-tbn1.gstatic.com/images?q=tbn:ANd9GcTgEGUPV2cG_-uCGA7MQw6BypHBInrKLq4CG6unzGffXqBGYujV" width="88" height="88">
        <button class='pure-button close animated hidden'>x</button>
    </div>

    <h2>Contextual Content</h2>
    <button class="popover pure-button btn" data-placement="above" data-content="Here's some additional content">Contextual Button</button>

    <script>
        YUI({
            gallery: 'gallery-2013.03.27-22-06',
            fetchCSS: false,
            filter: 'raw'
        }).use('event-hold', 'gallery-popover', 'event-outside', 'event-tap', 'event-gestures', function (Y) {
            function initKudo () {
                var kudo = Y.one('.kudo');
                kudo.on('gesturemovestart', function (e) {
                    if (!kudo.hasClass('complete')) {
                        kudo.addClass('activated');
                        Y.one('.text').setHTML('Dont let go!');
                    }

                });

                kudo.on('hold', function (e) {
                    kudo.removeClass('activated').addClass('complete');
                    Y.one('.text').setHTML('Voted!');
                }, { duration: 1000 });

                kudo.on('pointerup', function (e) {
                    kudo.removeClass('activated');
                    if (!kudo.hasClass('complete')) {
                        Y.one('.text').setHTML('Hold to add a vote');
                    }
                });
            }

            function initContextual () {
                var popover = new Y.Tipsy({
                    selector: ".popover",
                    width: 150,
                    showOn: { events: 'hold' },
                    hideOn: { events: 'release' }
                });

                popover.render();

                Y.one('.popover').on('hold', function (e) {
                    e.currentTarget.setHTML('Tooltip displayed');
                }, { preventDefault: true });

                Y.one('.popover').on('pointerup', function (e) {
                    e.currentTarget.setHTML('Contextual Button');
                });
            }

            function initState () {
                var module = Y.one('.module'),
                    img = module.one('img'),
                    button = module.one('.close');

                img.on('hold', function (e) {
                    img.addClass('wobble');
                    module.one('button').removeClass('hidden');
                }, { preventDefault: true });

                button.on('tap', function (e) {
                    if (img.hasClass('wobble')) {
                        module.one('button').addClass('hidden');
                        img.removeClass('wobble');
                    }
                });
            }
            initKudo();
            initContextual();
            initState();

        });
    </script>
</body>
</html>
